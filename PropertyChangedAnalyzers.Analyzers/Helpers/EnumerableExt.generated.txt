namespace PropertyChangedAnalyzers
{
    using System;
    using System.Collections.Generic;
    using System.Collections.Immutable;
    using Microsoft.CodeAnalysis;
    using Microsoft.CodeAnalysis.Text;

    internal static partial class EnumerableExt
    {

        internal static bool TryGetAtIndex<T>(this IReadOnlyList<T> source, int index, out T result)
        {
            result = default(T);
            if (source == null)
            {
                return false;
            }

            if (source.Count <= index)
            {
                return false;
            }

            result = source[index];
            return true;
        }

        internal static bool TryGetSingle<T>(this IReadOnlyList<T> source, out T result)
        {
            if (source.Count == 1)
            {
                result = source[0];
                return true;
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetSingle<T>(this IReadOnlyList<T> source, Func<T, bool> selector, out T result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetFirst<T>(this IReadOnlyList<T> source, out T result)
        {
            if (source.Count == 0)
            {
                result = default(T);
                return false;
            }

            result = source[0];
            return true;
        }

        internal static bool TryGetFirst<T>(this IReadOnlyList<T> source, Func<T, bool> selector, out T result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetLast<T>(this IReadOnlyList<T> source, out T result)
        {
            if (source.Count == 0)
            {
                result = default(T);
                return false;
            }

            result = source[source.Count - 1];
            return true;
        }

        internal static bool TryGetLast<T>(this IReadOnlyList<T> source, Func<T, bool> selector, out T result)
        {
            for (var i = source.Count - 1; i >= 0; i--)
            {
                var item = source[i];
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetAtIndex<T>(this ImmutableArray<T> source, int index, out T result)
        {
            result = default(T);
            if (source == null)
            {
                return false;
            }

            if (source.Count <= index)
            {
                return false;
            }

            result = source[index];
            return true;
        }

        internal static bool TryGetSingle<T>(this ImmutableArray<T> source, out T result)
        {
            if (source.Count == 1)
            {
                result = source[0];
                return true;
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetSingle<T>(this ImmutableArray<T> source, Func<T, bool> selector, out T result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetFirst<T>(this ImmutableArray<T> source, out T result)
        {
            if (source.Count == 0)
            {
                result = default(T);
                return false;
            }

            result = source[0];
            return true;
        }

        internal static bool TryGetFirst<T>(this ImmutableArray<T> source, Func<T, bool> selector, out T result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetLast<T>(this ImmutableArray<T> source, out T result)
        {
            if (source.Count == 0)
            {
                result = default(T);
                return false;
            }

            result = source[source.Count - 1];
            return true;
        }

        internal static bool TryGetLast<T>(this ImmutableArray<T> source, Func<T, bool> selector, out T result)
        {
            for (var i = source.Count - 1; i >= 0; i--)
            {
                var item = source[i];
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetAtIndex<SyntaxNodeOrToken>(this ChildSyntaxList source, int index, out SyntaxNodeOrToken result)
        {
            result = default(SyntaxNodeOrToken);
            if (source == null)
            {
                return false;
            }

            if (source.Count <= index)
            {
                return false;
            }

            result = source[index];
            return true;
        }

        internal static bool TryGetSingle<SyntaxNodeOrToken>(this ChildSyntaxList source, out SyntaxNodeOrToken result)
        {
            if (source.Count == 1)
            {
                result = source[0];
                return true;
            }

            result = default(SyntaxNodeOrToken);
            return false;
        }

        internal static bool TryGetSingle<SyntaxNodeOrToken>(this ChildSyntaxList source, Func<SyntaxNodeOrToken, bool> selector, out SyntaxNodeOrToken result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(SyntaxNodeOrToken);
            return false;
        }

        internal static bool TryGetFirst<SyntaxNodeOrToken>(this ChildSyntaxList source, out SyntaxNodeOrToken result)
        {
            if (source.Count == 0)
            {
                result = default(SyntaxNodeOrToken);
                return false;
            }

            result = source[0];
            return true;
        }

        internal static bool TryGetFirst<SyntaxNodeOrToken>(this ChildSyntaxList source, Func<SyntaxNodeOrToken, bool> selector, out SyntaxNodeOrToken result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(SyntaxNodeOrToken);
            return false;
        }

        internal static bool TryGetLast<SyntaxNodeOrToken>(this ChildSyntaxList source, out SyntaxNodeOrToken result)
        {
            if (source.Count == 0)
            {
                result = default(SyntaxNodeOrToken);
                return false;
            }

            result = source[source.Count - 1];
            return true;
        }

        internal static bool TryGetLast<SyntaxNodeOrToken>(this ChildSyntaxList source, Func<SyntaxNodeOrToken, bool> selector, out SyntaxNodeOrToken result)
        {
            for (var i = source.Count - 1; i >= 0; i--)
            {
                var item = source[i];
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(SyntaxNodeOrToken);
            return false;
        }

        internal static bool TryGetAtIndex<T>(this SeparatedSyntaxList<T> source, int index, out T result)
        {
            result = default(T);
            if (source == null)
            {
                return false;
            }

            if (source.Count <= index)
            {
                return false;
            }

            result = source[index];
            return true;
        }

        internal static bool TryGetSingle<T>(this SeparatedSyntaxList<T> source, out T result)
        {
            if (source.Count == 1)
            {
                result = source[0];
                return true;
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetSingle<T>(this SeparatedSyntaxList<T> source, Func<T, bool> selector, out T result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetFirst<T>(this SeparatedSyntaxList<T> source, out T result)
        {
            if (source.Count == 0)
            {
                result = default(T);
                return false;
            }

            result = source[0];
            return true;
        }

        internal static bool TryGetFirst<T>(this SeparatedSyntaxList<T> source, Func<T, bool> selector, out T result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetLast<T>(this SeparatedSyntaxList<T> source, out T result)
        {
            if (source.Count == 0)
            {
                result = default(T);
                return false;
            }

            result = source[source.Count - 1];
            return true;
        }

        internal static bool TryGetLast<T>(this SeparatedSyntaxList<T> source, Func<T, bool> selector, out T result)
        {
            for (var i = source.Count - 1; i >= 0; i--)
            {
                var item = source[i];
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetAtIndex<T>(this SyntaxList<T> source, int index, out T result)
        {
            result = default(T);
            if (source == null)
            {
                return false;
            }

            if (source.Count <= index)
            {
                return false;
            }

            result = source[index];
            return true;
        }

        internal static bool TryGetSingle<T>(this SyntaxList<T> source, out T result)
        {
            if (source.Count == 1)
            {
                result = source[0];
                return true;
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetSingle<T>(this SyntaxList<T> source, Func<T, bool> selector, out T result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetFirst<T>(this SyntaxList<T> source, out T result)
        {
            if (source.Count == 0)
            {
                result = default(T);
                return false;
            }

            result = source[0];
            return true;
        }

        internal static bool TryGetFirst<T>(this SyntaxList<T> source, Func<T, bool> selector, out T result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetLast<T>(this SyntaxList<T> source, out T result)
        {
            if (source.Count == 0)
            {
                result = default(T);
                return false;
            }

            result = source[source.Count - 1];
            return true;
        }

        internal static bool TryGetLast<T>(this SyntaxList<T> source, Func<T, bool> selector, out T result)
        {
            for (var i = source.Count - 1; i >= 0; i--)
            {
                var item = source[i];
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(T);
            return false;
        }

        internal static bool TryGetAtIndex<SyntaxNodeOrToken>(this SyntaxNodeOrTokenList source, int index, out SyntaxNodeOrToken result)
        {
            result = default(SyntaxNodeOrToken);
            if (source == null)
            {
                return false;
            }

            if (source.Count <= index)
            {
                return false;
            }

            result = source[index];
            return true;
        }

        internal static bool TryGetSingle<SyntaxNodeOrToken>(this SyntaxNodeOrTokenList source, out SyntaxNodeOrToken result)
        {
            if (source.Count == 1)
            {
                result = source[0];
                return true;
            }

            result = default(SyntaxNodeOrToken);
            return false;
        }

        internal static bool TryGetSingle<SyntaxNodeOrToken>(this SyntaxNodeOrTokenList source, Func<SyntaxNodeOrToken, bool> selector, out SyntaxNodeOrToken result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(SyntaxNodeOrToken);
            return false;
        }

        internal static bool TryGetFirst<SyntaxNodeOrToken>(this SyntaxNodeOrTokenList source, out SyntaxNodeOrToken result)
        {
            if (source.Count == 0)
            {
                result = default(SyntaxNodeOrToken);
                return false;
            }

            result = source[0];
            return true;
        }

        internal static bool TryGetFirst<SyntaxNodeOrToken>(this SyntaxNodeOrTokenList source, Func<SyntaxNodeOrToken, bool> selector, out SyntaxNodeOrToken result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(SyntaxNodeOrToken);
            return false;
        }

        internal static bool TryGetLast<SyntaxNodeOrToken>(this SyntaxNodeOrTokenList source, out SyntaxNodeOrToken result)
        {
            if (source.Count == 0)
            {
                result = default(SyntaxNodeOrToken);
                return false;
            }

            result = source[source.Count - 1];
            return true;
        }

        internal static bool TryGetLast<SyntaxNodeOrToken>(this SyntaxNodeOrTokenList source, Func<SyntaxNodeOrToken, bool> selector, out SyntaxNodeOrToken result)
        {
            for (var i = source.Count - 1; i >= 0; i--)
            {
                var item = source[i];
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(SyntaxNodeOrToken);
            return false;
        }

        internal static bool TryGetAtIndex<SyntaxToken>(this SyntaxTokenList source, int index, out SyntaxToken result)
        {
            result = default(SyntaxToken);
            if (source == null)
            {
                return false;
            }

            if (source.Count <= index)
            {
                return false;
            }

            result = source[index];
            return true;
        }

        internal static bool TryGetSingle<SyntaxToken>(this SyntaxTokenList source, out SyntaxToken result)
        {
            if (source.Count == 1)
            {
                result = source[0];
                return true;
            }

            result = default(SyntaxToken);
            return false;
        }

        internal static bool TryGetSingle<SyntaxToken>(this SyntaxTokenList source, Func<SyntaxToken, bool> selector, out SyntaxToken result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(SyntaxToken);
            return false;
        }

        internal static bool TryGetFirst<SyntaxToken>(this SyntaxTokenList source, out SyntaxToken result)
        {
            if (source.Count == 0)
            {
                result = default(SyntaxToken);
                return false;
            }

            result = source[0];
            return true;
        }

        internal static bool TryGetFirst<SyntaxToken>(this SyntaxTokenList source, Func<SyntaxToken, bool> selector, out SyntaxToken result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(SyntaxToken);
            return false;
        }

        internal static bool TryGetLast<SyntaxToken>(this SyntaxTokenList source, out SyntaxToken result)
        {
            if (source.Count == 0)
            {
                result = default(SyntaxToken);
                return false;
            }

            result = source[source.Count - 1];
            return true;
        }

        internal static bool TryGetLast<SyntaxToken>(this SyntaxTokenList source, Func<SyntaxToken, bool> selector, out SyntaxToken result)
        {
            for (var i = source.Count - 1; i >= 0; i--)
            {
                var item = source[i];
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(SyntaxToken);
            return false;
        }

        internal static bool TryGetAtIndex<SyntaxTrivia>(this SyntaxTriviaList source, int index, out SyntaxTrivia result)
        {
            result = default(SyntaxTrivia);
            if (source == null)
            {
                return false;
            }

            if (source.Count <= index)
            {
                return false;
            }

            result = source[index];
            return true;
        }

        internal static bool TryGetSingle<SyntaxTrivia>(this SyntaxTriviaList source, out SyntaxTrivia result)
        {
            if (source.Count == 1)
            {
                result = source[0];
                return true;
            }

            result = default(SyntaxTrivia);
            return false;
        }

        internal static bool TryGetSingle<SyntaxTrivia>(this SyntaxTriviaList source, Func<SyntaxTrivia, bool> selector, out SyntaxTrivia result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(SyntaxTrivia);
            return false;
        }

        internal static bool TryGetFirst<SyntaxTrivia>(this SyntaxTriviaList source, out SyntaxTrivia result)
        {
            if (source.Count == 0)
            {
                result = default(SyntaxTrivia);
                return false;
            }

            result = source[0];
            return true;
        }

        internal static bool TryGetFirst<SyntaxTrivia>(this SyntaxTriviaList source, Func<SyntaxTrivia, bool> selector, out SyntaxTrivia result)
        {
            foreach (var item in source)
            {
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(SyntaxTrivia);
            return false;
        }

        internal static bool TryGetLast<SyntaxTrivia>(this SyntaxTriviaList source, out SyntaxTrivia result)
        {
            if (source.Count == 0)
            {
                result = default(SyntaxTrivia);
                return false;
            }

            result = source[source.Count - 1];
            return true;
        }

        internal static bool TryGetLast<SyntaxTrivia>(this SyntaxTriviaList source, Func<SyntaxTrivia, bool> selector, out SyntaxTrivia result)
        {
            for (var i = source.Count - 1; i >= 0; i--)
            {
                var item = source[i];
                if (selector(item))
                {
                    result = item;
                    return true;
                }
            }

            result = default(SyntaxTrivia);
            return false;
        }
    }
}
